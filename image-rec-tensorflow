pip install tensorflow Pillow
from tensorflow.keras.applications.resnet50 import ResNet50, preprocess_input, decode_predictions
from tensorflow.keras.preprocessing import image as tf_image
import numpy as np
from PIL import Image
import os

def load_and_preprocess_image_resnet50(image_path):
    img = tf_image.load_img(image_path, target_size=(224, 224))
    img_array = tf_image.img_to_array(img)
    img_array = np.expand_dims(img_array, axis=0)
    img_array = preprocess_input(img_array)
    return img_array

def classify_image_resnet50(image_path):
    model = ResNet50(weights='imagenet')
    img_array = load_and_preprocess_image_resnet50(image_path)
    predictions = model.predict(img_array)
    decoded_predictions = decode_predictions(predictions)
    return decoded_predictions[0]

def display_predictions(predictions):
    for i, (imagenet_id, label, score) in enumerate(predictions):
        print(f"{i + 1}: {label} ({score:.2f})")

def main():
    image_path = os.path.join('/Users/skylargu/Desktop', 'penguin2.jpg')

    try:
        img = Image.open(image_path)
        img.show()
    except Exception as e:
        print(f"Error loading image: {e}")

    # Use the ResNet50 model for classification
    predictions = classify_image_resnet50(image_path)
    display_predictions(predictions)

if __name__ == "__main__":
    main()

